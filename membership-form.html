<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MBSTU Physics Alumni Association</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    body { font-family: 'Inter', sans-serif; }
    .nav-container {
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
    }
    .nav-container::-webkit-scrollbar { display: none; }
    
    /* Map styles */
    #alumni-map {
        border-radius: 0.5rem;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    }
    
    /* Custom marker styles */
    .custom-marker {
        background: white;
        border: 3px solid;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        overflow: hidden;
    }
    
    .marker-blue { border-color: #3b82f6; }
    
    /* Loading spinner */
    .loading-spinner {
        border: 4px solid #f3f4f6;
        border-top: 4px solid #7c3aed;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Professional gradient backgrounds for cards */
    .card-gradient-1 { background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%); }
    .card-gradient-2 { background: linear-gradient(135deg, #ffffff 0%, #faf5ff 100%); }
    .card-gradient-3 { background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%); }
    .card-gradient-4 { background: linear-gradient(135deg, #ffffff 0%, #fffbeb 100%); }
    .card-gradient-5 { background: linear-gradient(135deg, #ffffff 0%, #fef2f2 100%); }
    .card-gradient-6 { background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); }
    
    /* Gradient buttons */
    .gradient-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        transition: all 0.3s ease;
    }
    .gradient-btn:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .gradient-btn-blue {
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        color: white;
        transition: all 0.3s ease;
    }
    .gradient-btn-blue:hover {
        background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .gradient-btn-orange {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
        transition: all 0.3s ease;
    }
    .gradient-btn-orange:hover {
        background: linear-gradient(135deg, #eab308 0%, #b45309 100%);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .gradient-btn-green {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        transition: all 0.3s ease;
    }
    .gradient-btn-green:hover {
        background: linear-gradient(135deg, #0d9669 0%, #047857 100%);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
</style>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- Header and Navigation -->
<div class="bg-white shadow-md">
    <div class="header text-center py-4 bg-gradient-to-r from-blue-700 via-indigo-800 to-purple-900 text-white">
        <div class="max-w-7xl mx-auto px-4 flex flex-col sm:flex-row items-center justify-center sm:justify-between">
            <!-- Logo and Title Container -->
            <div class="flex items-center space-x-4 mb-4 sm:mb-0">
                <!-- Logo Container - Increased size -->
                <div class="logo-container w-24 h-24 bg-white rounded-full p-1 shadow-lg flex items-center justify-center">
                    <img src="assets/logo.png" alt="MBSTU Physics Alumni Association Logo" 
                         class="w-full h-full object-contain"
                         onerror="this.style.display='none'; document.querySelector('.logo-placeholder').style.display='flex';">
                    <!-- Fallback placeholder if logo doesn't load -->
                    <div class="logo-placeholder w-full h-full bg-gradient-to-br from-purple-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-lg hidden">
                        MPAA
                    </div>
                </div>
                
                <!-- Title Container -->
                <div class="text-left">
                    <div class="main-title text-2xl sm:text-3xl lg:text-4xl font-extrabold tracking-tight leading-tight">
                        MBSTU PHYSICS ALUMNI ASSOCIATION
                    </div>
                    <div class="university-name text-sm sm:text-base lg:text-lg font-semibold mt-1 opacity-90">
                        MAWLANA BHASHANI SCIENCE AND TECHNOLOGY UNIVERSITY
                    </div>
                </div>
            </div>
        </div>
    </div>
    <nav class="nav bg-white shadow-sm sticky top-0 z-50">
        <div class="nav-container max-w-7xl mx-auto flex justify-start items-center space-x-2 sm:space-x-4 p-4 overflow-x-auto whitespace-nowrap">
            <a href="index.html" class="nav-tab text-purple-600 font-bold border-b-2 border-purple-600 px-3 py-2 rounded-md text-sm sm:text-base">Home</a>
            <a href="membership-form.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Become a Member</a>
            <a href="members.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Current Members</a>
            <a href="committee.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Committee</a>
            <a href="alumni-news.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Alumni News</a>
            <a href="activities.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Activities</a>
            <a href="upcoming-events.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Upcoming Events</a>
            <a href="admin.html" class="nav-tab text-gray-600 hover:text-purple-600 transition duration-300 px-3 py-2 rounded-md text-sm sm:text-base font-medium">Admin</a>
        </div>
    </nav>
</div>

<!-- Main Content Area -->
<div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 space-y-8">

    <!-- Membership Form -->
    <div id="form-container" class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">
        <div class="bg-white shadow-xl rounded-2xl p-8 md:p-12">
            <h1 class="text-3xl font-bold text-purple-800 mb-2 text-center">Join Our Alumni Network</h1>
            <p class="text-gray-600 text-center mb-8">Reconnect with peers and stay updated with our community.</p>

            <!-- Step Indicators -->
            <div class="flex items-center justify-center mb-10">
                <div class="flex flex-col items-center">
                    <div id="step-indicator-1" class="step-indicator w-10 h-10 flex items-center justify-center rounded-full font-bold text-lg">1</div>
                    <p class="text-xs mt-2 font-medium">Personal</p>
                </div>
                <div class="flex-auto border-t-2 border-gray-200 mx-4"></div>
                <div class="flex flex-col items-center">
                    <div id="step-indicator-2" class="step-indicator w-10 h-10 flex items-center justify-center rounded-full font-bold text-lg">2</div>
                    <p class="text-xs mt-2 font-medium">Institutional</p>
                </div>
                <div class="flex-auto border-t-2 border-gray-200 mx-4"></div>
                <div class="flex flex-col items-center">
                    <div id="step-indicator-3" class="step-indicator w-10 h-10 flex items-center justify-center rounded-full font-bold text-lg">3</div>
                    <p class="text-xs mt-2 font-medium">Professional</p>
                </div>
                 <div class="flex-auto border-t-2 border-gray-200 mx-4"></div>
                 <div class="flex flex-col items-center">
                    <div id="step-indicator-4" class="step-indicator w-10 h-10 flex items-center justify-center rounded-full font-bold text-lg">4</div>
                    <p class="text-xs mt-2 font-medium">Mailing</p>
                </div>
                 <div class="flex-auto border-t-2 border-gray-200 mx-4"></div>
                 <div class="flex flex-col items-center">
                    <div id="step-indicator-5" class="step-indicator w-10 h-10 flex items-center justify-center rounded-full font-bold text-lg">5</div>
                    <p class="text-xs mt-2 font-medium">Submit</p>
                </div>
            </div>

            <form id="membership-form">
                <!-- Step 1: Personal Information -->
                <div id="step-1" class="space-y-6">
                    <div class="border-b border-gray-200 pb-6">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">STEP 1: Personal Information</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name <span class="text-red-500">*</span></label>
                                <input type="text" id="fullName" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="dob" class="block text-sm font-medium text-gray-700">Date of Birth <span class="text-red-500">*</span></label>
                                <input type="text" id="dob" placeholder="DD/MM/YYYY" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="fatherName" class="block text-sm font-medium text-gray-700">Father's Name <span class="text-red-500">*</span></label>
                                <input type="text" id="fatherName" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="motherName" class="block text-sm font-medium text-gray-700">Mother's Name <span class="text-red-500">*</span></label>
                                <input type="text" id="motherName" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                             <div>
                                <label for="gender" class="block text-sm font-medium text-gray-700">Gender <span class="text-red-500">*</span></label>
                                <select id="gender" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                                    <option value="" disabled selected>Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number <span class="text-red-500">*</span></label>
                                <div class="mt-1 flex rounded-md shadow-sm">
                                    <input type="text" id="countryCode" placeholder="+81" class="w-20 block px-3 py-2 border border-r-0 border-gray-300 bg-gray-50 rounded-l-md focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                                    <input type="tel" id="phone" placeholder="01712345678" class="flex-1 min-w-0 block w-full px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                                </div>
                            </div>
                             <div>
                                <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                                <input type="email" id="email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                             <div>
                                <label for="bloodGroup" class="block text-sm font-medium text-gray-700">Blood Group</label>
                                <select id="bloodGroup" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                                    <option value="" disabled selected>Select a group</option>
                                    <option value="A+">A+</option>
                                    <option value="A-">A-</option>
                                    <option value="B+">B+</option>
                                    <option value="B-">B-</option>
                                    <option value="AB+">AB+</option>
                                    <option value="AB-">AB-</option>
                                    <option value="O+">O+</option>
                                    <option value="O-">O-</option>
                                </select>
                            </div>
                             <div>
                                <label for="membershipType" class="block text-sm font-medium text-gray-700">Membership Type <span class="text-red-500">*</span></label>
                                <select id="membershipType" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                                    <option value="" disabled selected>Select a type</option>
                                    <option value="General">General</option>
                                    <option value="Permanent">Permanent</option>
                                    <option value="Donor">Donor</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Institutional Information -->
                <div id="step-2" class="hidden space-y-6">
                    <div class="border-b border-gray-200 pb-6">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">STEP 2: Institutional Information</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="season" class="block text-sm font-medium text-gray-700">Season <span class="text-red-500">*</span></label>
                                <input type="text" id="season" placeholder="2010-2011" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="batch" class="block text-sm font-medium text-gray-700">Batch <span class="text-red-500">*</span></label>
                                <input type="text" id="batch" placeholder="01" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="studentId" class="block text-sm font-medium text-gray-700">Student ID <span class="text-red-500">*</span></label>
                                <div class="mt-1 flex rounded-md shadow-sm border border-gray-300 focus-within:border-purple-500 focus-within:ring-1 focus-within:ring-purple-500">
                                    <span class="inline-flex items-center px-3 text-gray-500 sm:text-sm bg-gray-50 rounded-l-md border-r border-gray-300">PH</span>
                                    <input type="text" id="studentId" placeholder="11001" class="flex-1 min-w-0 block w-full px-3 py-2 border-0 rounded-r-md focus:ring-0 focus:border-0" required>
                                </div>
                            </div>
                             <div>
                                <label for="passingYear" class="block text-sm font-medium text-gray-700">Passing Year <span class="text-red-500">*</span></label>
                                <input type="text" id="passingYear" placeholder="2016" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div class="md:col-span-2">
                                <label for="degree" class="block text-sm font-medium text-gray-700">Degree Obtained <span class="text-red-500">*</span></label>
                                <select id="degree" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                                    <option>BSc</option>
                                    <option>MSc</option>
                                    <option>MPhil</option>
                                    <option>PhD</option>
                                </select>
                            </div>
                              <div>
                                <label for="supervisor" class="block text-sm font-medium text-gray-700">Supervisor</label>
                                <input type="text" id="supervisor" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Step 3: Professional Information & Photo -->
                <div id="step-3" class="hidden space-y-6">
                    <div class="border-b border-gray-200 pb-6">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">STEP 3: Professional Information</h2>
                        
                        <div class="flex items-center mb-6">
                            <input type="checkbox" id="jobPreparation" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                            <label for="jobPreparation" class="ml-2 block text-sm text-gray-900">In Preparation for Job</label>
                        </div>
                        
                        <div id="professional-fields" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="sector" class="block text-sm font-medium text-gray-700">Sector <span id="sector-req" class="text-red-500 hidden">*</span></label>
                                <input type="text" id="sector" placeholder="Teaching, HigherEdu" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label for="role" class="block text-sm font-medium text-gray-700">Role <span id="role-req" class="text-red-500 hidden">*</span></label>
                                <input type="text" id="role" placeholder="Lecturer, PhD Student" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label for="company" class="block text-sm font-medium text-gray-700">Company / Organization <span id="company-req" class="text-red-500 hidden">*</span></label>
                                <input type="text" id="company" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                             <div>
                                <label for="workCity" class="block text-sm font-medium text-gray-700">Work Place (City) <span id="workCity-req" class="text-red-500 hidden">*</span></label>
                                <input type="text" id="workCity" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                             <div>
                                <label for="workCountry" class="block text-sm font-medium text-gray-700">Work Place (Country) <span id="workCountry-req" class="text-red-500 hidden">*</span></label>
                                <input type="text" id="workCountry" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                             <div>
                                <label for="lastDegree" class="block text-sm font-medium text-gray-700">Last Degree (Optional)</label>
                                <select id="lastDegree" class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
									<option value="" selected>None</option>
                                    <option value="MSc">MSc</option>
                                    <option value="MPhil">MPhil</option>
                                    <option value="PhD">PhD</option>
                                </select>
                            </div>
                             <div>
                                <label for="university" class="block text-sm font-medium text-gray-700">University</label>
                                <input type="text" id="university" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div class="md:col-span-2">
                                <label for="linkedin" class="block text-sm font-medium text-gray-700">LinkedIn Profile URL</label>
                                <input type="url" id="linkedin" placeholder="https://www.linkedin.com/in/your-profile" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                        </div>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">Profile Picture</h2>
                        <div class="mt-1 flex items-center">
                            <span class="inline-block h-20 w-20 rounded-full overflow-hidden bg-gray-100">
                                <img id="photo-preview" src="https://placehold.co/128x128/e2e8f0/718096?text=Photo" alt="Photo preview" class="h-full w-full object-cover">
                            </span>
                            <input type="file" id="photo" accept="image/*" class="hidden">
                            <button type="button" id="upload-btn" class="ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
                                Upload Photo
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Mailing Address -->
                <div id="step-4" class="hidden space-y-6">
                    <div class="border-b border-gray-200 pb-6">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">STEP 4: Mailing Address</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="division" class="block text-sm font-medium text-gray-700">Division <span class="text-red-500">*</span></label>
                                <input type="text" id="division" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="district" class="block text-sm font-medium text-gray-700">District <span class="text-red-500">*</span></label>
                                <input type="text" id="district" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="subDistrict" class="block text-sm font-medium text-gray-700">Sub-district <span class="text-red-500">*</span></label>
                                <input type="text" id="subDistrict" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" required>
                            </div>
                            <div>
                                <label for="city" class="block text-sm font-medium text-gray-700">City / Town / Village / Area</label>
                                <input type="text" id="city" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label for="unionWard" class="block text-sm font-medium text-gray-700">Union / Ward</label>
                                <input type="text" id="unionWard" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label for="houseNumber" class="block text-sm font-medium text-gray-700">House / Building Number</label>
                                <input type="text" id="houseNumber" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div class="md:col-span-2">
                                <label for="street" class="block text-sm font-medium text-gray-700">Street / Road / Lane Name</label>
                                <input type="text" id="street" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label for="postalCode" class="block text-sm font-medium text-gray-700">Postal Code (Optional)</label>
                                <input type="text" id="postalCode" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Consent and Submission -->
                 <div id="step-5" class="hidden space-y-6">
                     <h2 class="text-xl font-semibold text-gray-700 mb-4">STEP 5: Consent & Declaration</h2>
                      <div class="mt-4 bg-gray-100 p-4 rounded-lg border border-gray-200">
                        <label class="flex items-start">
                            <input type="checkbox" id="consent" class="mt-1 h-5 w-5 text-purple-600 rounded focus:ring-purple-500" required>
                            <span id="consent-text" class="ml-3 text-sm text-gray-700">“I hereby declare that the information provided is accurate and I agree to be a member of the Alumni Association. I also agree that my personal information may be used and shared for the purpose of serving the Alumni Association and its activities.” <span class="text-red-500">*</span></span>
                        </label>
                    </div>
                </div>


                <!-- Navigation Buttons -->
                <div class="pt-5 flex justify-between">
                    <button type="button" id="prev-btn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-md transition hidden">
                        Previous
                    </button>
                    <button type="button" id="next-btn" class="ml-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-md transition">
                        Next
                    </button>
                    <button type="submit" id="submit-btn" class="w-full md:w-auto inline-flex justify-center py-3 px-8 border border-transparent shadow-sm text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-transform transform hover:scale-105 hidden">
                        Submit Application
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div id="success-modal" class="success-modal fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl p-8 text-center">
            <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-5">
                <svg class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
            </div>
            <h3 id="success-message-title" class="text-2xl md:text-3xl font-bold text-gray-900">Thank you for your application!</h3>
            <p class="mt-4 text-lg text-gray-600">Your application is in progress.</p>
            <div class="mt-6 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 text-left">
                <p class="font-bold text-lg">Important Payment Information:</p>
                <p class="text-base mt-2">The payment procedure will be sent by MPAA'S verified phone number and MPAA'S Facebook group. Do not make any payment except through these official channels.</p>
            </div>
            <p class="mt-6 text-sm text-gray-500">You will be redirected to the homepage shortly...</p>
        </div>
    </div>

	<!-- Footer -->
	<footer class="bg-gradient-to-r from-blue-700 via-indigo-800 to-purple-900 text-white text-center p-6 mt-8">
	    <p class="font-semibold">&copy; 2024 MBSTU PHYSICS ALUMNI ASSOCIATION. All Rights Reserved.</p>
	</footer>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwyrThNDw87LIPcvJFrqLN6gSJ2TSKHJ8YqPvrFX6lxBNHqfr_fS-SnNh9cvZd901Fd/exec';

    const form = document.getElementById('membership-form');
    const formContainer = document.getElementById('form-container');
    const photoInput = document.getElementById('photo');
    const uploadBtn = document.getElementById('upload-btn');
    const photoPreview = document.getElementById('photo-preview');
    let photoDataUrl = null;

    // Multi-step form logic
    const steps = [document.getElementById('step-1'), document.getElementById('step-2'), document.getElementById('step-3'), document.getElementById('step-4'), document.getElementById('step-5')];
    const stepIndicators = [document.getElementById('step-indicator-1'), document.getElementById('step-indicator-2'), document.getElementById('step-indicator-3'), document.getElementById('step-indicator-4'), document.getElementById('step-indicator-5')];
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');
    const membershipTypeSelect = document.getElementById('membershipType');
    let currentStep = 0;
    
    const jobPreparationCheckbox = document.getElementById('jobPreparation');
    const professionalFieldsToToggle = [
        document.getElementById('sector'),
        document.getElementById('role'),
        document.getElementById('company'),
        document.getElementById('workCity'),
        document.getElementById('workCountry')
    ];

    const professionalReqIndicators = [
        document.getElementById('sector-req'),
        document.getElementById('role-req'),
        document.getElementById('company-req'),
        document.getElementById('workCity-req'),
        document.getElementById('workCountry-req'),
    ];

    const toggleProfessionalFields = (isPreparing) => {
        professionalFieldsToToggle.forEach((field, index) => {
            field.disabled = isPreparing;
            field.required = !isPreparing;
            if(professionalReqIndicators[index]) {
                professionalReqIndicators[index].classList.toggle('hidden', isPreparing);
            }
            if (isPreparing) {
                field.value = '';
                field.classList.remove('border-red-500');
            }
        });
    };

    const updateStepUI = () => {
        const isDonor = membershipTypeSelect.value === 'Donor';

        steps.forEach((step, index) => {
            step.classList.toggle('hidden', index !== currentStep);
        });

        stepIndicators.forEach((indicator, index) => {
            indicator.classList.remove(
                'bg-purple-600', 'text-white', 'scale-110', 'shadow-lg', 
                'bg-green-600', 'text-white', 
                'bg-gray-300', 'text-gray-500', 'line-through', 
                'bg-gray-200', 'text-gray-500'
            );
            const p = indicator.nextElementSibling;
            p.classList.remove('text-purple-600', 'text-gray-500');

            if (isDonor && index === 1) { 
                indicator.classList.add('bg-gray-300', 'text-gray-500', 'line-through'); 
                p.classList.add('text-gray-500');
            } else if (index < currentStep) {
                indicator.classList.add('bg-green-600', 'text-white'); 
                p.classList.add('text-gray-500');
            } else if (index === currentStep) {
                indicator.classList.add('bg-purple-600', 'text-white', 'scale-110', 'shadow-lg'); 
                p.classList.add('text-purple-600');
            } else {
                 indicator.classList.add('bg-gray-200', 'text-gray-500'); 
                 p.classList.add('text-gray-500');
            }
        });

        prevBtn.classList.toggle('hidden', currentStep === 0);
        nextBtn.classList.toggle('hidden', currentStep === steps.length - 1);
        submitBtn.classList.toggle('hidden', currentStep !== steps.length - 1);
    };

    const validateStep = (stepIndex) => {
        if (membershipTypeSelect.value === 'Donor' && stepIndex === 1) {
            return true;
        }
        if (jobPreparationCheckbox.checked && stepIndex === 2) {
             professionalFieldsToToggle.forEach(f => f.classList.remove('border-red-500'));
             return true;
        }
        const currentStepDiv = steps[stepIndex];
        const inputs = currentStepDiv.querySelectorAll('input[required], select[required]');
        let isValid = true;
        for (const input of inputs) {
            if (input.disabled) {
                input.classList.remove('border-red-500');
                continue;
            }
            if (!input.checkValidity()) {
                input.classList.add('border-red-500');
                if (input.type === 'checkbox') {
                    document.getElementById('consent-text').classList.add('text-red-600', 'font-bold');
                } else {
                    input.reportValidity();
                }
                isValid = false;
                 break;
            } else {
                input.classList.remove('border-red-500');
                 if (input.type === 'checkbox') {
                    document.getElementById('consent-text').classList.remove('text-red-600', 'font-bold');
                }
            }
        }
        return isValid;
    };
    
    membershipTypeSelect.addEventListener('change', updateStepUI);
    jobPreparationCheckbox.addEventListener('change', () => toggleProfessionalFields(jobPreparationCheckbox.checked));
    
    toggleProfessionalFields(jobPreparationCheckbox.checked);


    nextBtn.addEventListener('click', () => {
        if (validateStep(currentStep)) {
            if (currentStep < steps.length - 1) {
                if (currentStep === 0 && membershipTypeSelect.value === 'Donor') {
                    currentStep = 2;
                } else {
                    currentStep++;
                }
                updateStepUI();
            }
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentStep > 0) {
            if (currentStep === 2 && membershipTypeSelect.value === 'Donor') {
                currentStep = 0;
            } else {
                currentStep--;
            }
            updateStepUI();
        }
    });

    updateStepUI();

    uploadBtn.addEventListener('click', () => photoInput.click());

    photoInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                photoDataUrl = e.target.result;
                photoPreview.src = photoDataUrl;
            };
            reader.readAsDataURL(file);
        }
    });

    function showSuccessModal(member) {
        const modal = document.getElementById('success-modal');
        const titleEl = document.getElementById('success-message-title');
        
        let salutation = '';
        if (member.professionalInfo.lastDegree === 'PhD') {
            salutation = `Dr. ${member.fullName}`;
        } else if (member.gender === 'Male') {
            salutation = `Mr. ${member.fullName}`;
        } else if (member.gender === 'Female') {
            salutation = `Ms. ${member.fullName}`;
        } else {
            salutation = member.fullName;
        }

        titleEl.innerHTML = `Dear ${salutation},<br>Thank you for your application!`;

        formContainer.classList.add('hidden');
        modal.classList.remove('hidden');

        setTimeout(() => {
            window.location.href = 'index.html';
        }, 10000);
    }

    form.addEventListener('submit', function (event) {
        event.preventDefault();
        
        if (!validateStep(currentStep)) return;
        
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';

        let alumniData;
        const storedData = localStorage.getItem('alumniData');
        alumniData = storedData ? JSON.parse(storedData) : { news: [], activities: [], events: [], members: [], pendingMembers: [], committee: [] };
        
        if (!alumniData.pendingMembers) alumniData.pendingMembers = [];

        const newMember = {
            id: Date.now(),
            membershipType: membershipTypeSelect.value,
            fullName: document.getElementById('fullName').value,
            dob: document.getElementById('dob').value,
            fatherName: document.getElementById('fatherName').value,
            motherName: document.getElementById('motherName').value,
            gender: document.getElementById('gender').value,
            email: document.getElementById('email').value,
            phone: `${document.getElementById('countryCode').value}${document.getElementById('phone').value}`,
            bloodGroup: document.getElementById('bloodGroup').value,
            institutionalInfo: {
                season: document.getElementById('season').value,
                batch: document.getElementById('batch').value,
                studentId: `PH${document.getElementById('studentId').value}`,
                passingYear: document.getElementById('passingYear').value,
                degree: document.getElementById('degree').value,
                supervisor: document.getElementById('supervisor').value,
            },
            professionalInfo: {
                jobPreparation: document.getElementById('jobPreparation').checked,
                sector: document.getElementById('sector').value,
                role: document.getElementById('role').value,
                company: document.getElementById('company').value,
                workCity: document.getElementById('workCity').value,
                workCountry: document.getElementById('workCountry').value,
                lastDegree: document.getElementById('lastDegree').value,
                university: document.getElementById('university').value,
                linkedin: document.getElementById('linkedin').value,
            },
            mailingAddress: {
                division: document.getElementById('division').value,
                district: document.getElementById('district').value,
                subDistrict: document.getElementById('subDistrict').value,
                city: document.getElementById('city').value,
                unionWard: document.getElementById('unionWard').value,
                houseNumber: document.getElementById('houseNumber').value,
                street: document.getElementById('street').value,
                postalCode: document.getElementById('postalCode').value
            },
            photoUrl: photoDataUrl
        };

        // Save to localStorage first
        alumniData.pendingMembers.push(newMember);
        localStorage.setItem('alumniData', JSON.stringify(alumniData));

        // Then, send the email
        if (WEB_APP_URL && WEB_APP_URL !== " ") {
            fetch(WEB_APP_URL, {
                method: 'POST',
                body: JSON.stringify(newMember)
            }).catch(err => {
                console.error("Error sending email request:", err);
            }).finally(() => {
                 showSuccessModal(newMember);
            });
        } else {
            console.warn("WEB_APP_URL is not set. Email will not be sent.");
            showSuccessModal(newMember);
        }
    });
});
</script>

</body>
</html>












